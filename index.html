<!DOCTYPE html>
<html lang="fr">

<head>
    <title>GRAW</title>
    <meta name="description" content="Garmin Race Around the World"/>
    <meta name="author" content="midorino@protonmail.com"/>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/favicon/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/favicon/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <!-- http://cdn.leafletjs.com/leaflet/v1.7.1/leaflet.zip -->
    <link rel="stylesheet" href="lib/leaflet-1.7.1/leaflet.css"/>
    <script src="lib/leaflet-1.7.1/leaflet.js"></script>

    <!-- https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.5.0/gpx.min.js -->
    <script src="lib/leaflet-gpx-1.5.0/leaflet-gpx.min.js"></script>

    <!-- https://raw.githubusercontent.com/Luuka/GPXParser.js/master/dist/GPXParser.min.js -->
    <script src="lib/gpxparser/gpxparser.min.js"></script>

    <!-- https://mapillary.github.io/mapillary-js/ -->
    <script src='https://unpkg.com/mapillary-js@3.0.0/dist/mapillary.min.js'></script>
    <link href='https://unpkg.com/mapillary-js@3.0.0/dist/mapillary.min.css' rel='stylesheet' />

    <!--
    <style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #mapid {
            height: 100%;
            width: 100%;
        }
    </style>
    -->
    <style>
        body { margin:0; padding:0; height: 100%; }
        #mapid { position: absolute; height: 100%; width: 66%; top: 0; left: 0; bottom: 0; }
        #mly { position: absolute; height: 100%; width: 33%; top: 0; right: 0; }
    </style>
</head>

<body>
    <div id="mapid"></div>

    <!-- MapillaryJS viewer test -->
    <!-- Ref: "Check if MapillaryJS is supported" - https://bl.ocks.org/oscarlorentzon/c737167e64d52668bb4991167501bb84 -->
    <div id='mly'></div>
    <div id="message"></div>

    <script>
        function setMessage(message) {
            var messageContainer = document.getElementById('message');
            messageContainer.innerHTML = message;
        }

        var componentOptions = null;

        if (Mapillary.isSupported()) {
            // Enable or disable any components, e.g. tag and popup which requires WebGL support
            // or use the default components by not supplying any component options.
            componentOptions = { /* Default options */ };

            setMessage("MapillaryJS is fully supported by your browser.");
        } else if (Mapillary.isFallbackSupported()) {
            // On top of the disabled components below, also the popup, marker and tag
            // components require WebGL support and should not be enabled (they are
            // disabled by default so does not need to be specified below).
            componentOptions = {
                // Disable components requiring WebGL support
                direction: false,
                imagePlane: false,
                keyboard: false,
                mouse: false,
                sequence: false,

                // Enable fallback components
                image: true,
                navigation: true,
            }

            setMessage("MapillaryJS fallback functionality is supported by your browser.");
        } else {
            // Handle the fact that MapillaryJS is not supported in a way that is
            // appropriate for your application.
            setMessage("MapillaryJS is not supported by your browser.");
        }

        if (!!componentOptions) {
            // Deactivate cover without interaction needed.
            componentOptions.cover = false;
            var clientId = "UlNMR2NIR1RGVWRYVkNySEtXOVZVZDo4Zjc4MzFlOGNiMTcyMDgw";
            var mly = new Mapillary.Viewer({
                container: "mly",
                apiClient: clientId,
                imageKey: '6ZcXjb82YuNEtPNA3fqBzA'
            });

            // Viewer size is dynamic so resize should be called every time the window size changes
            window.addEventListener("resize", function() { mly.resize(); });
        }
    </script>

    <script src="index.js"></script>
</body>

</html>